--- 
layout: post
title: "Personnaliser le nom d'un fichier upload\xC3\xA9 sous Symfony + Doctrine"
published: true
meta: 
  _edit_last: "1"
tags: 
- "D\xC3\xA9faut"
- doctrine
- snippet
- symfony
type: post
status: publish
---
Par défaut Symfony donne un nom de fichier hashé aux fichiers uploadés :
<pre lang="php">sha1($this->getOriginalName().rand(11111, 99999)).$this->getExtension($this->getOriginalExtension());</pre>
Rien de très explicite pour l'utilisateur qui va télécharger le fichier. Persuadé qu'une solution simple devait exister, une petite fouille dans les sources de Symfony s'imposa. Je note ici le résultat parce que je suis sûr que je l'aurai oublié d'ici quelques mois. Ça pourra aussi servir à quelqu'un (c'est aussi dans <a hreflang="en" href="http://www.symfony-project.org/jobeet/1_2/Doctrine/en/10">le tuto jobeet</a>).

La solution est d'implémenter la méthode <code>generate{ColonneDuFichier}Filename ($file)</code> dans la classe du modèle qui va stocker le chemin vers le fichier. Exemple pour la colonne "certificat" :

<pre lang="php">
public function generateCertificatFilename ($file)
{
  return "mynewfilename".$file->getExtension($file->getOriginalExtension());
}
</pre>
